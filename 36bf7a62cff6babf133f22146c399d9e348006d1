{
  "comments": [
    {
      "key": {
        "uuid": "236c2cd2_d83125e7",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/importer/GitGarbageCollectionStep.java",
        "patchSetId": 3
      },
      "lineNbr": 36,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2018-03-13T23:46:07Z",
      "side": 1,
      "message": "Does this class justify its existence? Compare:\n\n  gitGcStep.run(Collections.singletonList(targetProject));\n\nwith using this code inline:\n\n  garbageCollectionFactory.create().run(Collections.singletonList(targetProject));",
      "revId": "36bf7a62cff6babf133f22146c399d9e348006d1",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5a61b3ad_e05b3ed3",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/importer/ReplayChangesStep.java",
        "patchSetId": 3
      },
      "lineNbr": 26,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2018-03-13T21:06:32Z",
      "side": 1,
      "message": "Reformat issue?",
      "revId": "36bf7a62cff6babf133f22146c399d9e348006d1",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a1ad8231_095a18fc",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/importer/ReplayChangesStep.java",
        "patchSetId": 3
      },
      "lineNbr": 147,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2018-03-13T23:46:07Z",
      "side": 1,
      "message": "This is not formatted with google-java-format",
      "revId": "36bf7a62cff6babf133f22146c399d9e348006d1",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "710ff019_536911fd",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/importer/ReplayChangesStep.java",
        "patchSetId": 3
      },
      "lineNbr": 161,
      "author": {
        "id": 1062730
      },
      "writtenOn": "2018-03-13T02:13:06Z",
      "side": 1,
      "message": "Every 5000 changes may be not the best time to execute GC. \nProject changs\u003e5000 is not a common situation, maybe 1000 should be better?\nI suppose we can call \u0027GC\u0027 before \"for (ChangeInfo c : changes){**}\" (the first GC is most important), then call GC every 1000 or 2000 changes.",
      "range": {
        "startLine": 161,
        "startChar": 16,
        "endLine": 161,
        "endChar": 29
      },
      "revId": "36bf7a62cff6babf133f22146c399d9e348006d1",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "31c1b2e0_fe44fe57",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/importer/ReplayChangesStep.java",
        "patchSetId": 3
      },
      "lineNbr": 161,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2018-03-13T19:38:42Z",
      "side": 1,
      "message": "this number I estimated from what you posted on the mailing list and I cited in this commit\u0027s commit message. You said with running gc every 30 minutes you could reduce import time from 6 to 1 hours for a repository with 15k changes. If it took 1 hour this means you ran GC twice for 15k changes. This change now runs GC every 5000 changes which seems to be more gc runs than what you reported.\n\nMaybe we should make this a configuration option.",
      "parentUuid": "710ff019_536911fd",
      "range": {
        "startLine": 161,
        "startChar": 16,
        "endLine": 161,
        "endChar": 29
      },
      "revId": "36bf7a62cff6babf133f22146c399d9e348006d1",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bba1ba08_f8977cf0",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/importer/ReplayChangesStep.java",
        "patchSetId": 3
      },
      "lineNbr": 161,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2018-03-13T21:06:32Z",
      "side": 1,
      "message": "\u003e Maybe we should make this a configuration option.\n\n+1.",
      "parentUuid": "31c1b2e0_fe44fe57",
      "range": {
        "startLine": 161,
        "startChar": 16,
        "endLine": 161,
        "endChar": 29
      },
      "revId": "36bf7a62cff6babf133f22146c399d9e348006d1",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "baaddac5_ef0101df",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/importer/ReplayChangesStep.java",
        "patchSetId": 3
      },
      "lineNbr": 161,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2018-03-13T21:34:49Z",
      "side": 1,
      "message": "ok, where should this configuration option be stored ?",
      "parentUuid": "bba1ba08_f8977cf0",
      "range": {
        "startLine": 161,
        "startChar": 16,
        "endLine": 161,
        "endChar": 29
      },
      "revId": "36bf7a62cff6babf133f22146c399d9e348006d1",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e8a62d9_f7321de6",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/importer/ReplayChangesStep.java",
        "patchSetId": 3
      },
      "lineNbr": 161,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2018-03-13T23:46:07Z",
      "side": 1,
      "message": "Looks like this plugin does not have any configuration currently [1], no config.md.\n\nAs usual, we have a choice between having a plugin specific subsection in gerrit.config:\n\n  [plugin \"importer\"]\n    gcChangeLimit \u003d 5000\n\nor have a plugin specific config file, importer.config:\n\n  [gc]\n    changeLimit \u003d 5000\n\n[1] https://gerrit.googlesource.com/plugins/importer/+/36bf7a62cff6babf133f22146c399d9e348006d1/src/main/resources/Documentation/",
      "parentUuid": "baaddac5_ef0101df",
      "range": {
        "startLine": 161,
        "startChar": 16,
        "endLine": 161,
        "endChar": 29
      },
      "revId": "36bf7a62cff6babf133f22146c399d9e348006d1",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b30ccb8e_0b2ed0ed",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/importer/ReplayChangesStep.java",
        "patchSetId": 3
      },
      "lineNbr": 162,
      "author": {
        "id": 1062730
      },
      "writtenOn": "2018-03-13T02:13:06Z",
      "side": 1,
      "message": "I didn\u0027t know to much about Gerrit source, so I\u0027m not sure whether this could be an issue.\nIf a project is GC by multiple threads, then \"efs/meta/config in ***: LOCK_FAILURE\" error may occur, we should handle this possible concurrent scene.",
      "range": {
        "startLine": 162,
        "startChar": 14,
        "endLine": 162,
        "endChar": 70
      },
      "revId": "36bf7a62cff6babf133f22146c399d9e348006d1",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e8fc8a27_9a2a18b6",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/importer/ReplayChangesStep.java",
        "patchSetId": 3
      },
      "lineNbr": 162,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2018-03-13T19:38:42Z",
      "side": 1,
      "message": "GarbageCollection [1] ensures that at most one concurrent thread runs GC on the same project, if another thread tries to schedule another gc concurrently this additional run will be skipped\n\n[1] https://gerrit.googlesource.com/gerrit/+/stable-2.14/gerrit-server/src/main/java/com/google/gerrit/server/git/GarbageCollection.java#76",
      "parentUuid": "b30ccb8e_0b2ed0ed",
      "range": {
        "startLine": 162,
        "startChar": 14,
        "endLine": 162,
        "endChar": 70
      },
      "revId": "36bf7a62cff6babf133f22146c399d9e348006d1",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}